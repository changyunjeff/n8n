# N8Nè‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å®Œæ•´æŒ‡å—

> **æ•™ç¨‹ç†å¿µ**ï¼šæœ¬æ•™ç¨‹é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„è‚¡ç¥¨APIèŠ‚ç‚¹å¼€å‘æ¡ˆä¾‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ä»é›¶å¼€å§‹åˆ›å»ºN8Nè‡ªå®šä¹‰èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬Credentialç®¡ç†ã€å¤šAPIæ”¯æŒã€ç»Ÿä¸€è¾“å‡ºæ ¼å¼ç­‰æ ¸å¿ƒæŠ€èƒ½ã€‚

---

## é—®é¢˜å¼•å…¥

å½“ä½ ä½¿ç”¨N8Næ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šä½ éœ€è¦è°ƒç”¨æŸä¸ªAPIï¼Œä½†N8Nä¸­æ²¡æœ‰ç°æˆçš„èŠ‚ç‚¹ï¼›æˆ–è€…ä½ éœ€è¦è°ƒç”¨å¤šä¸ªç±»ä¼¼çš„APIï¼ˆæ¯”å¦‚ä¸åŒçš„è‚¡ç¥¨æ•°æ®APIï¼‰ï¼Œä½†å®ƒä»¬çš„è®¤è¯æ–¹å¼å’Œè¾“å‡ºæ ¼å¼å„ä¸ç›¸åŒï¼Œä½ å¸Œæœ›åˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„èŠ‚ç‚¹æ¥å¤„ç†è¿™äº›å·®å¼‚ã€‚

æ¯”å¦‚ï¼Œä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªè‚¡ç¥¨æ•°æ®æŸ¥è¯¢èŠ‚ç‚¹ï¼Œæ”¯æŒå¤šä¸ªè‚¡ç¥¨APIæä¾›å•†ï¼ˆå¦‚Alpha Vantageã€Finnhubã€Polygon.ioï¼‰ï¼Œæ¯ä¸ªAPIéƒ½æœ‰è‡ªå·±çš„API Keyï¼Œä½†æœ€ç»ˆè¾“å‡ºçš„æ•°æ®æ ¼å¼è¦ç»Ÿä¸€ã€‚è¿™æ ·ï¼Œæ— è®ºä½¿ç”¨å“ªä¸ªAPIï¼Œåç»­çš„å·¥ä½œæµèŠ‚ç‚¹éƒ½èƒ½ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†æ•°æ®ã€‚

è¿™å°±æ˜¯è‡ªå®šä¹‰èŠ‚ç‚¹çš„ä»·å€¼æ‰€åœ¨ã€‚é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰èŠ‚ç‚¹ï¼Œä½ å¯ä»¥ï¼š
- **å°è£…å¤æ‚é€»è¾‘**ï¼šå°†APIè°ƒç”¨ã€æ•°æ®å¤„ç†ç­‰é€»è¾‘å°è£…åœ¨èŠ‚ç‚¹ä¸­
- **ç»Ÿä¸€æ¥å£**ï¼šå³ä½¿åº•å±‚ä½¿ç”¨ä¸åŒçš„APIï¼Œä¹Ÿèƒ½æä¾›ç»Ÿä¸€çš„è¾“å…¥è¾“å‡ºæ¥å£
- **å¤ç”¨ä»£ç **ï¼šä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„ä½¿ç”¨
- **å¢å¼ºåŠŸèƒ½**ï¼šæ·»åŠ N8NåŸç”ŸèŠ‚ç‚¹æ²¡æœ‰çš„åŠŸèƒ½

æœ¬æ•™ç¨‹å°†é€šè¿‡å¼€å‘ä¸€ä¸ª**è‚¡ç¥¨æ•°æ®æŸ¥è¯¢èŠ‚ç‚¹**çš„å®Œæ•´æ¡ˆä¾‹ï¼Œå¸¦ä½ ä»é›¶å¼€å§‹æŒæ¡N8Nè‡ªå®šä¹‰èŠ‚ç‚¹çš„å¼€å‘æŠ€èƒ½ã€‚

---

## æ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯N8Nè‡ªå®šä¹‰èŠ‚ç‚¹ï¼Ÿ

**è‡ªå®šä¹‰èŠ‚ç‚¹ï¼ˆCustom Nodeï¼‰**æ˜¯N8Nä¸­å…è®¸å¼€å‘è€…åˆ›å»ºè‡ªå·±çš„èŠ‚ç‚¹ç±»å‹çš„åŠŸèƒ½ã€‚å®ƒå…è®¸ä½ ï¼š
- å®šä¹‰èŠ‚ç‚¹çš„è¾“å…¥è¾“å‡º
- å®šä¹‰èŠ‚ç‚¹çš„é…ç½®é€‰é¡¹
- å®šä¹‰èŠ‚ç‚¹çš„æ‰§è¡Œé€»è¾‘
- å®šä¹‰èŠ‚ç‚¹çš„è®¤è¯æ–¹å¼ï¼ˆCredentialï¼‰

**ç±»æ¯”ç†è§£**ï¼š
- **åŸç”ŸèŠ‚ç‚¹**ï¼šå°±åƒN8Næä¾›çš„æ ‡å‡†ç§¯æœ¨å—
- **è‡ªå®šä¹‰èŠ‚ç‚¹**ï¼šå°±åƒä½ è‡ªå·±è®¾è®¡å’Œåˆ¶ä½œçš„ç§¯æœ¨å—ï¼Œå¯ä»¥æŒ‰ç…§ä½ çš„éœ€æ±‚å®šåˆ¶

### è‡ªå®šä¹‰èŠ‚ç‚¹çš„ç»„æˆéƒ¨åˆ†

ä¸€ä¸ªå®Œæ•´çš„è‡ªå®šä¹‰èŠ‚ç‚¹åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

| ç»„æˆéƒ¨åˆ† | è¯´æ˜ | æ–‡ä»¶ä½ç½® |
|---------|------|---------|
| **èŠ‚ç‚¹å®šä¹‰** | å®šä¹‰èŠ‚ç‚¹çš„åç§°ã€æè¿°ã€å›¾æ ‡ã€å±æ€§ç­‰ | `nodes/YourNode/YourNode.node.json` |
| **èŠ‚ç‚¹ä»£ç ** | å®ç°èŠ‚ç‚¹çš„æ‰§è¡Œé€»è¾‘ | `nodes/YourNode/YourNode.ts` |
| **Credentialå®šä¹‰** | å®šä¹‰èŠ‚ç‚¹çš„è®¤è¯æ–¹å¼ | `credentials/YourCredential/YourCredential.credentials.ts` |
| **èŠ‚ç‚¹æè¿°** | èŠ‚ç‚¹çš„è¯¦ç»†è¯´æ˜æ–‡æ¡£ | `nodes/YourNode/YourNode.description.md` |

### å¼€å‘ç¯å¢ƒè¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿ä½ å…·å¤‡ä»¥ä¸‹ç¯å¢ƒï¼š

| è¦æ±‚ | è¯´æ˜ | ç‰ˆæœ¬è¦æ±‚ |
|------|------|---------|
| **Node.js** | JavaScriptè¿è¡Œç¯å¢ƒ | >= 16.0.0 |
| **npm** | åŒ…ç®¡ç†å™¨ | >= 7.0.0 |
| **TypeScript** | ç±»å‹å®‰å…¨çš„JavaScript | >= 4.0.0 |
| **Git** | ç‰ˆæœ¬æ§åˆ¶å·¥å…· | æœ€æ–°ç‰ˆæœ¬ |
| **ä»£ç ç¼–è¾‘å™¨** | VS Codeæ¨è | æœ€æ–°ç‰ˆæœ¬ |

### æ¡ˆä¾‹éœ€æ±‚åˆ†æ

æˆ‘ä»¬çš„æ¡ˆä¾‹æ˜¯åˆ›å»ºä¸€ä¸ª**è‚¡ç¥¨æ•°æ®æŸ¥è¯¢èŠ‚ç‚¹**ï¼Œå…·ä½“éœ€æ±‚å¦‚ä¸‹ï¼š

**åŠŸèƒ½éœ€æ±‚**ï¼š
1. æ”¯æŒå¤šä¸ªè‚¡ç¥¨APIæä¾›å•†ï¼ˆAlpha Vantageã€Finnhubã€Polygon.ioï¼‰
2. æ¯ä¸ªAPIéœ€è¦ä¸åŒçš„API Keyè¿›è¡Œè®¤è¯
3. ç”¨æˆ·å¯ä»¥åœ¨èŠ‚ç‚¹ä¸­é€‰æ‹©ä½¿ç”¨å“ªä¸ªAPI
4. è¾“å…¥è‚¡ç¥¨ä»£ç ï¼Œè¾“å‡ºç»Ÿä¸€çš„è‚¡ç¥¨æ•°æ®æ ¼å¼

**æŠ€æœ¯éœ€æ±‚**ï¼š
1. åˆ›å»ºè‡ªå®šä¹‰Credentialç±»å‹ï¼Œæ”¯æŒå¤šä¸ªAPI Key
2. åˆ›å»ºè‡ªå®šä¹‰èŠ‚ç‚¹ï¼Œæ”¯æŒAPIé€‰æ‹©
3. å®ç°ç»Ÿä¸€çš„è¾“å‡ºæ ¼å¼è½¬æ¢
4. å¤„ç†ä¸åŒAPIçš„é”™è¯¯å“åº”

**è¾“å‡ºæ ¼å¼ç»Ÿä¸€**ï¼š
æ— è®ºä½¿ç”¨å“ªä¸ªAPIï¼Œè¾“å‡ºæ ¼å¼éƒ½åº”è¯¥æ˜¯ï¼š
```json
{
  "symbol": "AAPL",
  "name": "Apple Inc.",
  "price": 150.25,
  "change": 2.5,
  "changePercent": 1.69,
  "volume": 50000000,
  "marketCap": 2500000000000,
  "timestamp": "2024-01-15T10:30:00Z"
}
```

---

## è¯¦ç»†æ•™ç¨‹

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å¼€å‘ç¯å¢ƒ

#### 1.1 å…‹éš†N8Nä»“åº“

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è·å–N8Nçš„æºä»£ç ï¼Œä»¥ä¾¿åœ¨å…¶ä¸­æ·»åŠ è‡ªå®šä¹‰èŠ‚ç‚¹ã€‚

```bash
# å…‹éš†N8Nä»“åº“
git clone https://github.com/n8n-io/n8n.git
cd n8n

# å®‰è£…ä¾èµ–
npm install
```

#### 1.2 äº†è§£N8Né¡¹ç›®ç»“æ„

N8Nçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

```
n8n/
â”œâ”€â”€ nodes/              # èŠ‚ç‚¹å®šä¹‰ç›®å½•
â”‚   â”œâ”€â”€ base/          # åŸºç¡€èŠ‚ç‚¹
â”‚   â”œâ”€â”€ n8n-nodes-base/ # åŸºç¡€èŠ‚ç‚¹åº“
â”‚   â””â”€â”€ [YourNode]/    # ä½ çš„è‡ªå®šä¹‰èŠ‚ç‚¹ï¼ˆå¾…åˆ›å»ºï¼‰
â”œâ”€â”€ credentials/        # Credentialå®šä¹‰ç›®å½•
â”‚   â””â”€â”€ [YourCredential]/ # ä½ çš„è‡ªå®šä¹‰Credentialï¼ˆå¾…åˆ›å»ºï¼‰
â”œâ”€â”€ package.json        # é¡¹ç›®é…ç½®
â””â”€â”€ tsconfig.json       # TypeScripté…ç½®
```

#### 1.3 åˆ›å»ºå¼€å‘åˆ†æ”¯

```bash
# åˆ›å»ºå¼€å‘åˆ†æ”¯
git checkout -b custom-stock-node

# ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•
pwd  # åº”è¯¥æ˜¾ç¤º n8n ç›®å½•è·¯å¾„
```

---

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºCredentialç±»å‹

#### 2.1 ç†è§£Credentialçš„ä½œç”¨

Credentialç”¨äºå­˜å‚¨å’Œç®¡ç†è®¤è¯ä¿¡æ¯ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œéœ€è¦æ”¯æŒå¤šä¸ªAPI Keyï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿå­˜å‚¨å¤šä¸ªAPI Keyçš„Credentialç±»å‹ã€‚

**è®¾è®¡æ€è·¯**ï¼š
- åˆ›å»ºä¸€ä¸ªCredentialç±»å‹ï¼š`StockApiCredential`
- æ”¯æŒå­˜å‚¨å¤šä¸ªAPIçš„Keyï¼š
  - `alphaVantageApiKey`: Alpha Vantageçš„API Key
  - `finnhubApiKey`: Finnhubçš„API Key
  - `polygonApiKey`: Polygon.ioçš„API Key

#### 2.2 åˆ›å»ºCredentialç›®å½•ç»“æ„

```bash
# åœ¨credentialsç›®å½•ä¸‹åˆ›å»ºæ–°ç›®å½•
mkdir -p credentials/StockApiCredential
cd credentials/StockApiCredential
```

#### 2.3 åˆ›å»ºCredentialå®šä¹‰æ–‡ä»¶

åˆ›å»ºæ–‡ä»¶ `StockApiCredential.credentials.ts`ï¼š

```typescript
import {
	ICredentialType,
	INodeProperties,
} from 'n8n-workflow';

export class StockApiCredential implements ICredentialType {
	name = 'stockApiCredential';
	displayName = 'Stock API Credential';
	documentationUrl = 'https://docs.n8n.io/integrations/stock-api';
	properties: INodeProperties[] = [
		{
			displayName: 'Alpha Vantage API Key',
			name: 'alphaVantageApiKey',
			type: 'string',
			typeOptions: {
				password: true,
			},
			default: '',
			description: 'API Key for Alpha Vantage. Get it from https://www.alphavantage.co/support/#api-key',
		},
		{
			displayName: 'Finnhub API Key',
			name: 'finnhubApiKey',
			type: 'string',
			typeOptions: {
				password: true,
			},
			default: '',
			description: 'API Key for Finnhub. Get it from https://finnhub.io/register',
		},
		{
			displayName: 'Polygon.io API Key',
			name: 'polygonApiKey',
			type: 'string',
			typeOptions: {
				password: true,
			},
			default: '',
			description: 'API Key for Polygon.io. Get it from https://polygon.io/dashboard/signup',
		},
	];
}
```

**ä»£ç è¯´æ˜**ï¼š
- `ICredentialType`: N8Nçš„Credentialç±»å‹æ¥å£
- `name`: Credentialçš„å†…éƒ¨æ ‡è¯†ç¬¦
- `displayName`: åœ¨N8Nç•Œé¢ä¸­æ˜¾ç¤ºçš„åç§°
- `properties`: å®šä¹‰Credentialçš„å±æ€§ï¼ˆAPI Keysï¼‰
- `typeOptions.password: true`: è¡¨ç¤ºè¿™æ˜¯å¯†ç å­—æ®µï¼Œè¾“å…¥æ—¶ä¼šéšè—

#### 2.4 æ³¨å†ŒCredential

åœ¨ `credentials/index.ts` ä¸­æ³¨å†Œæ–°çš„Credentialï¼š

```typescript
import { StockApiCredential } from './StockApiCredential/StockApiCredential.credentials';

// åœ¨å¯¼å‡ºåˆ—è¡¨ä¸­æ·»åŠ 
export const credentialsTypes = {
	// ... å…¶ä»–credentials
	stockApiCredential: StockApiCredential,
};
```

---

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºè‡ªå®šä¹‰èŠ‚ç‚¹

#### 3.1 åˆ›å»ºèŠ‚ç‚¹ç›®å½•ç»“æ„

```bash
# è¿”å›åˆ°n8næ ¹ç›®å½•
cd ../..

# åˆ›å»ºèŠ‚ç‚¹ç›®å½•
mkdir -p nodes/StockData
cd nodes/StockData
```

#### 3.2 åˆ›å»ºèŠ‚ç‚¹å®šä¹‰æ–‡ä»¶

åˆ›å»ºæ–‡ä»¶ `StockData.node.json`ï¼š

```json
{
	"node": {
		"version": 1,
		"name": "stockData",
		"displayName": "Stock Data",
		"description": "Query stock data from multiple APIs (Alpha Vantage, Finnhub, Polygon.io)",
		"defaults": {
			"name": "Stock Data"
		},
		"inputs": ["main"],
		"outputs": ["main"],
		"credentials": [
			{
				"name": "stockApiCredential",
				"required": true
			}
		],
		"properties": [
			{
				"displayName": "API Provider",
				"name": "apiProvider",
				"type": "options",
				"options": [
					{
						"name": "Alpha Vantage",
						"value": "alphaVantage"
					},
					{
						"name": "Finnhub",
						"value": "finnhub"
					},
					{
						"name": "Polygon.io",
						"value": "polygon"
					}
				],
				"default": "alphaVantage",
				"required": true,
				"description": "Select the stock API provider to use"
			},
			{
				"displayName": "Stock Symbol",
				"name": "symbol",
				"type": "string",
				"default": "AAPL",
				"required": true,
				"description": "The stock symbol to query (e.g., AAPL, MSFT, GOOGL)"
			},
			{
				"displayName": "Additional Fields",
				"name": "additionalFields",
				"type": "collection",
				"placeholder": "Add Field",
				"default": {},
				"options": [
					{
						"displayName": "Output Size",
						"name": "outputSize",
						"type": "options",
						"options": [
							{
								"name": "Compact",
								"value": "compact"
							},
							{
								"name": "Full",
								"value": "full"
							}
						],
						"default": "compact",
						"description": "The size of the output data (only for Alpha Vantage)"
					}
				]
			}
		]
	}
}
```

**é…ç½®è¯´æ˜**ï¼š
- `name`: èŠ‚ç‚¹çš„å†…éƒ¨æ ‡è¯†ç¬¦
- `displayName`: åœ¨N8Nç•Œé¢ä¸­æ˜¾ç¤ºçš„åç§°
- `credentials`: æŒ‡å®šèŠ‚ç‚¹ä½¿ç”¨çš„Credentialç±»å‹
- `properties`: å®šä¹‰èŠ‚ç‚¹çš„é…ç½®é€‰é¡¹
  - `apiProvider`: é€‰æ‹©APIæä¾›å•†
  - `symbol`: è‚¡ç¥¨ä»£ç 
  - `additionalFields`: é¢å¤–é…ç½®é€‰é¡¹

#### 3.3 åˆ›å»ºèŠ‚ç‚¹æ‰§è¡Œä»£ç 

åˆ›å»ºæ–‡ä»¶ `StockData.ts`ï¼š

```typescript
import {
	IExecuteFunctions,
	INodeExecutionData,
	INodeType,
	INodeTypeDescription,
	NodePropertyTypes,
} from 'n8n-workflow';
import { IDataObject } from 'n8n-workflow';
import { OptionsWithUri } from 'request';

export class StockData implements INodeType {
	description: INodeTypeDescription = {
		displayName: 'Stock Data',
		name: 'stockData',
		icon: 'file:stock.svg',
		group: ['transform'],
		version: 1,
		subtitle: '={{$parameter["apiProvider"]}} - {{$parameter["symbol"]}}',
		description: 'Query stock data from multiple APIs',
		defaults: {
			name: 'Stock Data',
		},
		inputs: ['main'],
		outputs: ['main'],
		credentials: [
			{
				name: 'stockApiCredential',
				required: true,
			},
		],
		properties: [
			{
				displayName: 'API Provider',
				name: 'apiProvider',
				type: 'options',
				options: [
					{
						name: 'Alpha Vantage',
						value: 'alphaVantage',
					},
					{
						name: 'Finnhub',
						value: 'finnhub',
					},
					{
						name: 'Polygon.io',
						value: 'polygon',
					},
				],
				default: 'alphaVantage',
				required: true,
				description: 'Select the stock API provider to use',
			},
			{
				displayName: 'Stock Symbol',
				name: 'symbol',
				type: 'string',
				default: 'AAPL',
				required: true,
				description: 'The stock symbol to query (e.g., AAPL, MSFT, GOOGL)',
			},
			{
				displayName: 'Additional Fields',
				name: 'additionalFields',
				type: 'collection',
				placeholder: 'Add Field',
				default: {},
				options: [
					{
						displayName: 'Output Size',
						name: 'outputSize',
						type: 'options',
						options: [
							{
								name: 'Compact',
								value: 'compact',
							},
							{
								name: 'Full',
								value: 'full',
							},
						],
						default: 'compact',
						description: 'The size of the output data (only for Alpha Vantage)',
					},
				],
			},
		],
	};

	async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
		const items = this.getInputData();
		const returnData: INodeExecutionData[] = [];

		for (let i = 0; i < items.length; i++) {
			try {
				const apiProvider = this.getNodeParameter('apiProvider', i) as string;
				const symbol = this.getNodeParameter('symbol', i) as string;
				const additionalFields = this.getNodeParameter('additionalFields', i) as IDataObject;

				// è·å–Credential
				const credentials = await this.getCredentials('stockApiCredential');

				// æ ¹æ®é€‰æ‹©çš„APIæä¾›å•†è°ƒç”¨ä¸åŒçš„API
				let stockData: IDataObject;
				switch (apiProvider) {
					case 'alphaVantage':
						stockData = await this.callAlphaVantage(symbol, credentials, additionalFields);
						break;
					case 'finnhub':
						stockData = await this.callFinnhub(symbol, credentials);
						break;
					case 'polygon':
						stockData = await this.callPolygon(symbol, credentials);
						break;
					default:
						throw new Error(`Unsupported API provider: ${apiProvider}`);
				}

				// ç»Ÿä¸€è¾“å‡ºæ ¼å¼
				const unifiedData = this.unifyOutputFormat(stockData, symbol, apiProvider);

				returnData.push({
					json: unifiedData,
					pairedItem: {
						item: i,
					},
				});
			} catch (error) {
				if (this.continueOnFail()) {
					returnData.push({
						json: {
							error: error.message,
						},
						pairedItem: {
							item: i,
						},
					});
					continue;
				}
				throw error;
			}
		}

		return [returnData];
	}

	/**
	 * è°ƒç”¨Alpha Vantage API
	 */
	private async callAlphaVantage(
		symbol: string,
		credentials: IDataObject,
		additionalFields: IDataObject,
	): Promise<IDataObject> {
		const apiKey = credentials.alphaVantageApiKey as string;
		if (!apiKey) {
			throw new Error('Alpha Vantage API Key is required');
		}

		const outputSize = (additionalFields.outputSize as string) || 'compact';

		const options: OptionsWithUri = {
			method: 'GET',
			uri: 'https://www.alphavantage.co/query',
			qs: {
				function: 'GLOBAL_QUOTE',
				symbol: symbol,
				apikey: apiKey,
			},
			json: true,
		};

		const response = await this.helpers.request(options);

		if (response['Error Message']) {
			throw new Error(`Alpha Vantage API Error: ${response['Error Message']}`);
		}

		if (response['Note']) {
			throw new Error(`Alpha Vantage API Rate Limit: ${response['Note']}`);
		}

		const quote = response['Global Quote'];
		if (!quote) {
			throw new Error('Invalid response from Alpha Vantage API');
		}

		return {
			symbol: quote['01. symbol'],
			price: parseFloat(quote['05. price']),
			change: parseFloat(quote['09. change']),
			changePercent: parseFloat(quote['10. change percent'].replace('%', '')),
			volume: parseInt(quote['06. volume'], 10),
			high: parseFloat(quote['03. high']),
			low: parseFloat(quote['04. low']),
			open: parseFloat(quote['02. open']),
			previousClose: parseFloat(quote['08. previous close']),
			timestamp: quote['07. latest trading day'],
			apiProvider: 'alphaVantage',
		};
	}

	/**
	 * è°ƒç”¨Finnhub API
	 */
	private async callFinnhub(symbol: string, credentials: IDataObject): Promise<IDataObject> {
		const apiKey = credentials.finnhubApiKey as string;
		if (!apiKey) {
			throw new Error('Finnhub API Key is required');
		}

		const options: OptionsWithUri = {
			method: 'GET',
			uri: 'https://finnhub.io/api/v1/quote',
			qs: {
				symbol: symbol,
				token: apiKey,
			},
			json: true,
		};

		const response = await this.helpers.request(options);

		if (response.error) {
			throw new Error(`Finnhub API Error: ${response.error}`);
		}

		// è·å–å…¬å¸ä¿¡æ¯
		const profileOptions: OptionsWithUri = {
			method: 'GET',
			uri: 'https://finnhub.io/api/v1/stock/profile2',
			qs: {
				symbol: symbol,
				token: apiKey,
			},
			json: true,
		};

		const profile = await this.helpers.request(profileOptions);

		return {
			symbol: symbol,
			price: response.c,
			change: response.d,
			changePercent: response.dp,
			volume: response.v,
			high: response.h,
			low: response.l,
			open: response.o,
			previousClose: response.pc,
			timestamp: new Date(response.t * 1000).toISOString(),
			name: profile.name || symbol,
			marketCap: profile.marketCapitalization || null,
			apiProvider: 'finnhub',
		};
	}

	/**
	 * è°ƒç”¨Polygon.io API
	 */
	private async callPolygon(symbol: string, credentials: IDataObject): Promise<IDataObject> {
		const apiKey = credentials.polygonApiKey as string;
		if (!apiKey) {
			throw new Error('Polygon.io API Key is required');
		}

		// è·å–æœ€æ–°æŠ¥ä»·
		const options: OptionsWithUri = {
			method: 'GET',
			uri: `https://api.polygon.io/v2/aggs/ticker/${symbol}/prev`,
			qs: {
				adjusted: 'true',
				apikey: apiKey,
			},
			json: true,
		};

		const response = await this.helpers.request(options);

		if (response.status !== 'OK') {
			throw new Error(`Polygon.io API Error: ${response.status}`);
		}

		if (!response.results || response.results.length === 0) {
			throw new Error('No data returned from Polygon.io API');
		}

		const result = response.results[0];
		const previousClose = result.c; // æ”¶ç›˜ä»·ä½œä¸ºå½“å‰ä»·æ ¼ï¼ˆå› ä¸ºprevæ˜¯å‰ä¸€ä¸ªäº¤æ˜“æ—¥ï¼‰

		// è·å–å®æ—¶æŠ¥ä»·ï¼ˆå¦‚æœå¯ç”¨ï¼‰
		let currentPrice = previousClose;
		try {
			const snapshotOptions: OptionsWithUri = {
				method: 'GET',
				uri: `https://api.polygon.io/v2/snapshot/locale/us/markets/stocks/tickers/${symbol}`,
				qs: {
					apikey: apiKey,
				},
				json: true,
			};

			const snapshot = await this.helpers.request(snapshotOptions);
			if (snapshot.ticker && snapshot.ticker.day) {
				currentPrice = snapshot.ticker.day.c; // å½“å‰æ”¶ç›˜ä»·
			}
		} catch (error) {
			// å¦‚æœå®æ—¶æŠ¥ä»·å¤±è´¥ï¼Œä½¿ç”¨å‰ä¸€ä¸ªäº¤æ˜“æ—¥çš„æ”¶ç›˜ä»·
			console.warn('Failed to get real-time quote, using previous close');
		}

		const change = currentPrice - previousClose;
		const changePercent = (change / previousClose) * 100;

		return {
			symbol: symbol,
			price: currentPrice,
			change: change,
			changePercent: changePercent,
			volume: result.v,
			high: result.h,
			low: result.l,
			open: result.o,
			previousClose: previousClose,
			timestamp: new Date(result.t).toISOString(),
			apiProvider: 'polygon',
		};
	}

	/**
	 * ç»Ÿä¸€è¾“å‡ºæ ¼å¼
	 */
	private unifyOutputFormat(
		data: IDataObject,
		symbol: string,
		apiProvider: string,
	): IDataObject {
		return {
			symbol: data.symbol || symbol,
			name: data.name || symbol,
			price: data.price || 0,
			change: data.change || 0,
			changePercent: data.changePercent || 0,
			volume: data.volume || 0,
			high: data.high || null,
			low: data.low || null,
			open: data.open || null,
			previousClose: data.previousClose || null,
			marketCap: data.marketCap || null,
			timestamp: data.timestamp || new Date().toISOString(),
			apiProvider: apiProvider,
			rawData: data, // ä¿ç•™åŸå§‹æ•°æ®ä»¥ä¾¿è°ƒè¯•
		};
	}
}
```

**ä»£ç è¯´æ˜**ï¼š
- `execute`: èŠ‚ç‚¹çš„ä¸»è¦æ‰§è¡Œå‡½æ•°
- `callAlphaVantage`, `callFinnhub`, `callPolygon`: è°ƒç”¨ä¸åŒAPIçš„æ–¹æ³•
- `unifyOutputFormat`: ç»Ÿä¸€è¾“å‡ºæ ¼å¼çš„æ–¹æ³•
- `this.helpers.request`: N8Næä¾›çš„HTTPè¯·æ±‚è¾…åŠ©æ–¹æ³•
- `this.getCredentials`: è·å–Credentialçš„æ–¹æ³•
- `this.getNodeParameter`: è·å–èŠ‚ç‚¹å‚æ•°çš„æ–¹æ³•

#### 3.4 æ³¨å†ŒèŠ‚ç‚¹

åœ¨ `nodes/index.ts` ä¸­æ³¨å†Œæ–°èŠ‚ç‚¹ï¼š

```typescript
import { StockData } from './StockData/StockData';

// åœ¨å¯¼å‡ºåˆ—è¡¨ä¸­æ·»åŠ 
export const nodes = [
	// ... å…¶ä»–èŠ‚ç‚¹
	StockData,
];
```

---

### ç¬¬å››æ­¥ï¼šç¼–è¯‘å’Œæµ‹è¯•

#### 4.1 ç¼–è¯‘TypeScriptä»£ç 

```bash
# è¿”å›åˆ°n8næ ¹ç›®å½•
cd ../..

# ç¼–è¯‘TypeScript
npm run build
```

#### 4.2 å¯åŠ¨N8Nå¼€å‘æœåŠ¡å™¨

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

#### 4.3 åœ¨N8Nä¸­æµ‹è¯•èŠ‚ç‚¹

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5678`
2. åˆ›å»ºæ–°å·¥ä½œæµ
3. åœ¨èŠ‚ç‚¹åˆ—è¡¨ä¸­æ‰¾åˆ° "Stock Data" èŠ‚ç‚¹
4. æ·»åŠ èŠ‚ç‚¹åˆ°å·¥ä½œæµ
5. é…ç½®Credentialï¼š
   - ç‚¹å‡» "Credentials" ä¸‹æ‹‰èœå•
   - é€‰æ‹© "Create New Credential"
   - é€‰æ‹© "Stock API Credential"
   - è¾“å…¥è‡³å°‘ä¸€ä¸ªAPI Keyï¼ˆAlpha Vantageã€Finnhubæˆ–Polygon.ioï¼‰
6. é…ç½®èŠ‚ç‚¹ï¼š
   - é€‰æ‹©API Provider
   - è¾“å…¥Stock Symbolï¼ˆå¦‚ï¼šAAPLï¼‰
7. æ‰§è¡Œå·¥ä½œæµå¹¶æŸ¥çœ‹ç»“æœ

---

### ç¬¬äº”æ­¥ï¼šä¼˜åŒ–å’Œå¢å¼º

#### 5.1 æ·»åŠ é”™è¯¯å¤„ç†

åœ¨èŠ‚ç‚¹ä»£ç ä¸­æ·»åŠ æ›´å®Œå–„çš„é”™è¯¯å¤„ç†ï¼š

```typescript
private async callAlphaVantage(
	symbol: string,
	credentials: IDataObject,
	additionalFields: IDataObject,
): Promise<IDataObject> {
	const apiKey = credentials.alphaVantageApiKey as string;
	if (!apiKey) {
		throw new Error('Alpha Vantage API Key is required. Please configure it in credentials.');
	}

	try {
		const options: OptionsWithUri = {
			method: 'GET',
			uri: 'https://www.alphavantage.co/query',
			qs: {
				function: 'GLOBAL_QUOTE',
				symbol: symbol,
				apikey: apiKey,
			},
			json: true,
			timeout: 10000, // 10ç§’è¶…æ—¶
		};

		const response = await this.helpers.request(options);

		// å¤„ç†APIé”™è¯¯å“åº”
		if (response['Error Message']) {
			throw new Error(`Alpha Vantage API Error: ${response['Error Message']}`);
		}

		if (response['Note']) {
			throw new Error(`Alpha Vantage API Rate Limit: ${response['Note']}. Please wait a moment and try again.`);
		}

		// éªŒè¯å“åº”æ•°æ®
		const quote = response['Global Quote'];
		if (!quote || !quote['05. price']) {
			throw new Error('Invalid response from Alpha Vantage API. The stock symbol may not exist.');
		}

		// ... å…¶ä½™ä»£ç 
	} catch (error) {
		if (error.code === 'ETIMEDOUT') {
			throw new Error('Request to Alpha Vantage API timed out. Please try again.');
		}
		if (error.code === 'ENOTFOUND') {
			throw new Error('Cannot connect to Alpha Vantage API. Please check your internet connection.');
		}
		throw error;
	}
}
```

#### 5.2 æ·»åŠ ç¼“å­˜æœºåˆ¶

ä¸ºäº†é¿å…é¢‘ç¹è°ƒç”¨APIï¼Œå¯ä»¥æ·»åŠ ç®€å•çš„ç¼“å­˜æœºåˆ¶ï¼š

```typescript
// åœ¨ç±»ä¸­æ·»åŠ ç¼“å­˜å±æ€§
private cache: Map<string, { data: IDataObject; timestamp: number }> = new Map();
private readonly CACHE_TTL = 60000; // ç¼“å­˜1åˆ†é’Ÿ

private getCachedData(key: string): IDataObject | null {
	const cached = this.cache.get(key);
	if (cached && Date.now() - cached.timestamp < this.CACHE_TTL) {
		return cached.data;
	}
	return null;
}

private setCachedData(key: string, data: IDataObject): void {
	this.cache.set(key, {
		data,
		timestamp: Date.now(),
	});
}
```

#### 5.3 æ·»åŠ æ—¥å¿—è®°å½•

```typescript
// åœ¨æ‰§è¡Œæ–¹æ³•ä¸­æ·»åŠ æ—¥å¿—
async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
	const items = this.getInputData();
	const returnData: INodeExecutionData[] = [];

	for (let i = 0; i < items.length; i++) {
		try {
			const apiProvider = this.getNodeParameter('apiProvider', i) as string;
			const symbol = this.getNodeParameter('symbol', i) as string;

			// è®°å½•æ—¥å¿—
			this.logger.info(`Querying stock data for ${symbol} using ${apiProvider}`);

			// ... æ‰§è¡Œé€»è¾‘

			this.logger.info(`Successfully retrieved data for ${symbol}`);
		} catch (error) {
			this.logger.error(`Error querying stock data: ${error.message}`);
			// ... é”™è¯¯å¤„ç†
		}
	}

	return [returnData];
}
```

---

## å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šåˆ›å»ºåŸºç¡€èŠ‚ç‚¹

**ä»»åŠ¡ç›®æ ‡**ï¼šåˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰èŠ‚ç‚¹ï¼Œè¾“å‡ºå›ºå®šçš„JSONæ•°æ®ã€‚

**å‰ç½®æ¡ä»¶**ï¼š
- å·²å®‰è£…Node.jså’Œnpm
- å·²å…‹éš†N8Nä»“åº“
- å·²å®‰è£…ä¾èµ–

**è¯¦ç»†æ­¥éª¤**ï¼š

1. **åˆ›å»ºèŠ‚ç‚¹ç›®å½•**
   ```bash
   mkdir -p nodes/HelloWorld
   cd nodes/HelloWorld
   ```

2. **åˆ›å»ºèŠ‚ç‚¹å®šä¹‰æ–‡ä»¶** `HelloWorld.node.json`
   ```json
   {
     "node": {
       "version": 1,
       "name": "helloWorld",
       "displayName": "Hello World",
       "description": "A simple hello world node",
       "defaults": {
         "name": "Hello World"
       },
       "inputs": ["main"],
       "outputs": ["main"],
       "properties": []
     }
   }
   ```

3. **åˆ›å»ºèŠ‚ç‚¹ä»£ç æ–‡ä»¶** `HelloWorld.ts`
   ```typescript
   import {
     IExecuteFunctions,
     INodeExecutionData,
     INodeType,
     INodeTypeDescription,
   } from 'n8n-workflow';

   export class HelloWorld implements INodeType {
     description: INodeTypeDescription = {
       displayName: 'Hello World',
       name: 'helloWorld',
       icon: 'file:hello.svg',
       group: ['transform'],
       version: 1,
       description: 'A simple hello world node',
       defaults: {
         name: 'Hello World',
       },
       inputs: ['main'],
       outputs: ['main'],
       properties: [],
     };

     async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
       const returnData: INodeExecutionData[] = [{
         json: {
           message: 'Hello World from N8N!',
           timestamp: new Date().toISOString(),
         },
       }];

       return [returnData];
     }
   }
   ```

4. **æ³¨å†ŒèŠ‚ç‚¹**ï¼ˆåœ¨ `nodes/index.ts` ä¸­ï¼‰
5. **ç¼–è¯‘å¹¶æµ‹è¯•**

**é¢„æœŸç»“æœ**ï¼šèŠ‚ç‚¹èƒ½å¤ŸæˆåŠŸæ‰§è¡Œï¼Œè¾“å‡ºåŒ…å« "Hello World from N8N!" çš„æ¶ˆæ¯ã€‚

**éªŒè¯æ–¹æ³•**ï¼š
- åœ¨N8Nä¸­åˆ›å»ºæ–°å·¥ä½œæµ
- æ·»åŠ Hello WorldèŠ‚ç‚¹
- æ‰§è¡Œå·¥ä½œæµ
- æ£€æŸ¥è¾“å‡ºæ•°æ®

---

### ç»ƒä¹ 2ï¼šæ·»åŠ Credentialæ”¯æŒ

**ä»»åŠ¡ç›®æ ‡**ï¼šä¸ºHello WorldèŠ‚ç‚¹æ·»åŠ Credentialæ”¯æŒï¼Œä»Credentialä¸­è¯»å–é…ç½®ã€‚

**è¯¦ç»†æ­¥éª¤**ï¼š

1. **åˆ›å»ºCredentialç±»å‹** `HelloWorldCredential.credentials.ts`
2. **å®šä¹‰Credentialå±æ€§**ï¼ˆå¦‚ï¼šç”¨æˆ·åã€å¯†ç ï¼‰
3. **åœ¨èŠ‚ç‚¹ä¸­ä½¿ç”¨Credential**
4. **æµ‹è¯•Credentialé…ç½®**

**é¢„æœŸç»“æœ**ï¼šèŠ‚ç‚¹èƒ½å¤Ÿä»Credentialä¸­è¯»å–é…ç½®å¹¶ä½¿ç”¨ã€‚

---

### ç»ƒä¹ 3ï¼šå®Œå–„è‚¡ç¥¨æ•°æ®èŠ‚ç‚¹

**ä»»åŠ¡ç›®æ ‡**ï¼šåŸºäºæœ¬æ•™ç¨‹çš„æ¡ˆä¾‹ï¼Œå®Œå–„è‚¡ç¥¨æ•°æ®èŠ‚ç‚¹ï¼Œæ·»åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **æ”¯æŒæ‰¹é‡æŸ¥è¯¢**ï¼šä¸€æ¬¡æŸ¥è¯¢å¤šä¸ªè‚¡ç¥¨
2. **æ·»åŠ æ•°æ®éªŒè¯**ï¼šéªŒè¯è‚¡ç¥¨ä»£ç æ ¼å¼
3. **æ·»åŠ é‡è¯•æœºåˆ¶**ï¼šAPIè°ƒç”¨å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
4. **ä¼˜åŒ–è¾“å‡ºæ ¼å¼**ï¼šæ·»åŠ æ›´å¤šå­—æ®µï¼ˆå¦‚ï¼š52å‘¨æœ€é«˜/æœ€ä½ä»·ï¼‰

**è¯¦ç»†æ­¥éª¤**ï¼š

1. **ä¿®æ”¹èŠ‚ç‚¹å±æ€§**ï¼Œæ·»åŠ æ‰¹é‡æŸ¥è¯¢é€‰é¡¹
2. **å®ç°æ‰¹é‡æŸ¥è¯¢é€»è¾‘**
3. **æ·»åŠ æ•°æ®éªŒè¯å‡½æ•°**
4. **å®ç°é‡è¯•æœºåˆ¶**
5. **æ‰©å±•è¾“å‡ºæ ¼å¼**

**é¢„æœŸç»“æœ**ï¼šèŠ‚ç‚¹èƒ½å¤Ÿæ‰¹é‡æŸ¥è¯¢è‚¡ç¥¨æ•°æ®ï¼Œå…·å¤‡å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶ã€‚

---

## å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘æ—¶å‡ºç°TypeScripté”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**A**: å¸¸è§çš„TypeScripté”™è¯¯åŠè§£å†³æ–¹æ³•ï¼š

1. **ç±»å‹é”™è¯¯**ï¼šç¡®ä¿æ‰€æœ‰ç±»å‹éƒ½æ­£ç¡®å®šä¹‰
   ```typescript
   // é”™è¯¯
   const apiKey = credentials.apiKey;
   
   // æ­£ç¡®
   const apiKey = credentials.apiKey as string;
   ```

2. **å¯¼å…¥é”™è¯¯**ï¼šç¡®ä¿å¯¼å…¥è·¯å¾„æ­£ç¡®
   ```typescript
   // ç¡®ä¿ä»æ­£ç¡®çš„åŒ…å¯¼å…¥
   import { IExecuteFunctions } from 'n8n-workflow';
   ```

3. **å±æ€§ä¸å­˜åœ¨**ï¼šæ£€æŸ¥N8Nç‰ˆæœ¬ï¼ŒæŸäº›å±æ€§å¯èƒ½åœ¨ä¸åŒç‰ˆæœ¬ä¸­ä¸åŒ

### Q2: èŠ‚ç‚¹åœ¨N8Nä¸­ä¸æ˜¾ç¤ºæ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. **èŠ‚ç‚¹æ˜¯å¦å·²æ³¨å†Œ**ï¼šæ£€æŸ¥ `nodes/index.ts` ä¸­çš„å¯¼å‡º
2. **ç¼–è¯‘æ˜¯å¦æˆåŠŸ**ï¼šè¿è¡Œ `npm run build` æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
3. **é‡å¯N8N**ï¼šä¿®æ”¹èŠ‚ç‚¹åéœ€è¦é‡å¯N8N
4. **æ¸…é™¤ç¼“å­˜**ï¼šåˆ é™¤ `.n8n` ç›®å½•å¹¶é‡æ–°å¯åŠ¨

### Q3: Credentialæ— æ³•ä¿å­˜æ€ä¹ˆåŠï¼Ÿ

**A**: å¯èƒ½çš„åŸå› ï¼š

1. **Credentialæœªæ³¨å†Œ**ï¼šæ£€æŸ¥ `credentials/index.ts`
2. **å±æ€§å®šä¹‰é”™è¯¯**ï¼šæ£€æŸ¥Credentialå±æ€§å®šä¹‰
3. **ç±»å‹ä¸åŒ¹é…**ï¼šç¡®ä¿å±æ€§ç±»å‹æ­£ç¡®

### Q4: APIè°ƒç”¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: è°ƒè¯•æ­¥éª¤ï¼š

1. **æ£€æŸ¥API Key**ï¼šç¡®ä¿API Keyæ­£ç¡®ä¸”æœ‰æ•ˆ
2. **æ£€æŸ¥ç½‘ç»œè¿æ¥**ï¼šç¡®ä¿èƒ½å¤Ÿè®¿é—®APIç«¯ç‚¹
3. **æŸ¥çœ‹é”™è¯¯ä¿¡æ¯**ï¼šæ£€æŸ¥N8Næ‰§è¡Œæ—¥å¿—
4. **æµ‹è¯•API**ï¼šä½¿ç”¨curlæˆ–Postmanç›´æ¥æµ‹è¯•API
5. **æ£€æŸ¥é¢‘ç‡é™åˆ¶**ï¼šæŸäº›APIæœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶

### Q5: å¦‚ä½•è°ƒè¯•è‡ªå®šä¹‰èŠ‚ç‚¹ï¼Ÿ

**A**: è°ƒè¯•æ–¹æ³•ï¼š

1. **ä½¿ç”¨console.log**ï¼šåœ¨ä»£ç ä¸­æ·»åŠ æ—¥å¿—
2. **ä½¿ç”¨N8Næ—¥å¿—**ï¼šä½¿ç”¨ `this.logger` è®°å½•æ—¥å¿—
3. **æ£€æŸ¥æ‰§è¡Œå†å²**ï¼šåœ¨N8Nä¸­æŸ¥çœ‹èŠ‚ç‚¹æ‰§è¡Œå†å²
4. **ä½¿ç”¨è°ƒè¯•å™¨**ï¼šåœ¨VS Codeä¸­è®¾ç½®æ–­ç‚¹è°ƒè¯•

### Q6: å¦‚ä½•å‘å¸ƒè‡ªå®šä¹‰èŠ‚ç‚¹ï¼Ÿ

**A**: å‘å¸ƒæ­¥éª¤ï¼š

1. **åˆ›å»ºnpmåŒ…**ï¼šå°†èŠ‚ç‚¹æ‰“åŒ…ä¸ºnpmåŒ…
2. **å‘å¸ƒåˆ°npm**ï¼šä½¿ç”¨ `npm publish`
3. **åˆ›å»ºæ–‡æ¡£**ï¼šç¼–å†™ä½¿ç”¨æ–‡æ¡£
4. **æäº¤åˆ°N8Nç¤¾åŒº**ï¼šå¯ä»¥æäº¤åˆ°N8Nç¤¾åŒºèŠ‚ç‚¹åˆ—è¡¨

### Q7: å¦‚ä½•å¤„ç†ä¸åŒAPIçš„å“åº”æ ¼å¼å·®å¼‚ï¼Ÿ

**A**: æœ€ä½³å®è·µï¼š

1. **ç»Ÿä¸€è¾“å‡ºæ ¼å¼**ï¼šåˆ›å»ºç»Ÿä¸€çš„æ•°æ®ç»“æ„
2. **æ•°æ®è½¬æ¢å‡½æ•°**ï¼šä¸ºæ¯ä¸ªAPIåˆ›å»ºè½¬æ¢å‡½æ•°
3. **é”™è¯¯å¤„ç†**ï¼šå¤„ç†ä¸åŒAPIçš„é”™è¯¯æ ¼å¼
4. **æ•°æ®éªŒè¯**ï¼šéªŒè¯è½¬æ¢åçš„æ•°æ®å®Œæ•´æ€§

### Q8: å¦‚ä½•ä¼˜åŒ–èŠ‚ç‚¹æ€§èƒ½ï¼Ÿ

**A**: ä¼˜åŒ–å»ºè®®ï¼š

1. **æ·»åŠ ç¼“å­˜**ï¼šé¿å…é‡å¤APIè°ƒç”¨
2. **æ‰¹é‡å¤„ç†**ï¼šä¸€æ¬¡å¤„ç†å¤šä¸ªé¡¹ç›®
3. **å¼‚æ­¥å¤„ç†**ï¼šä½¿ç”¨Promise.allå¹¶è¡Œå¤„ç†
4. **å‡å°‘APIè°ƒç”¨**ï¼šåˆå¹¶å¤šä¸ªAPIè°ƒç”¨ä¸ºä¸€ä¸ª

---

## çŸ¥è¯†æ£€æŸ¥

### é€‰æ‹©é¢˜

1. **è‡ªå®šä¹‰èŠ‚ç‚¹çš„å®šä¹‰æ–‡ä»¶æ˜¯ä»€ä¹ˆæ ¼å¼ï¼Ÿ**
   - A. JSON
   - B. TypeScript
   - C. JavaScript
   - D. YAML
   - **ç­”æ¡ˆ**ï¼šAï¼ˆèŠ‚ç‚¹å®šä¹‰æ˜¯JSONæ ¼å¼ï¼Œæ‰§è¡Œä»£ç æ˜¯TypeScriptï¼‰

2. **Credentialçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ**
   - A. å­˜å‚¨èŠ‚ç‚¹é…ç½®
   - B. å­˜å‚¨è®¤è¯ä¿¡æ¯
   - C. å­˜å‚¨å·¥ä½œæµæ•°æ®
   - D. å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
   - **ç­”æ¡ˆ**ï¼šB

3. **å¦‚ä½•è·å–èŠ‚ç‚¹å‚æ•°ï¼Ÿ**
   - A. `this.getParameter()`
   - B. `this.getNodeParameter()`
   - C. `this.getConfig()`
   - D. `this.getSettings()`
   - **ç­”æ¡ˆ**ï¼šB

4. **å¦‚ä½•è·å–Credentialï¼Ÿ**
   - A. `this.getCredentials()`
   - B. `this.getAuth()`
   - C. `this.getCredential()`
   - D. `this.getToken()`
   - **ç­”æ¡ˆ**ï¼šA

5. **èŠ‚ç‚¹çš„æ‰§è¡Œå‡½æ•°è¿”å›ä»€ä¹ˆç±»å‹ï¼Ÿ**
   - A. `Promise<INodeExecutionData>`
   - B. `Promise<INodeExecutionData[]>`
   - C. `Promise<INodeExecutionData[][]>`
   - D. `Promise<void>`
   - **ç­”æ¡ˆ**ï¼šCï¼ˆè¿”å›äºŒç»´æ•°ç»„ï¼Œå› ä¸ºå¯èƒ½æœ‰å¤šä¸ªè¾“å‡ºï¼‰

### å®è·µé¢˜

1. **åˆ›å»ºä¸€ä¸ªç®€å•çš„HTTPè¯·æ±‚èŠ‚ç‚¹**
   - è¦æ±‚ï¼šèƒ½å¤Ÿå‘é€GETè¯·æ±‚åˆ°æŒ‡å®šURL
   - è¾“å…¥ï¼šURL
   - è¾“å‡ºï¼šå“åº”æ•°æ®

2. **ä¸ºèŠ‚ç‚¹æ·»åŠ æ¡ä»¶åˆ¤æ–­**
   - è¦æ±‚ï¼šæ ¹æ®è¾“å…¥æ•°æ®çš„ä¸åŒå€¼æ‰§è¡Œä¸åŒé€»è¾‘
   - ä½¿ç”¨IFèŠ‚ç‚¹æˆ–SwitchèŠ‚ç‚¹çš„é€»è¾‘

3. **å®ç°æ•°æ®è½¬æ¢èŠ‚ç‚¹**
   - è¦æ±‚ï¼šå°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼
   - æ”¯æŒå¤šç§è½¬æ¢è§„åˆ™

---

## å»¶ä¼¸é˜…è¯»

### å®˜æ–¹èµ„æº

1. **N8NèŠ‚ç‚¹å¼€å‘æ–‡æ¡£**
   - ç½‘å€ï¼šhttps://docs.n8n.io/integrations/creating-nodes/
   - å†…å®¹ï¼šå®˜æ–¹èŠ‚ç‚¹å¼€å‘æŒ‡å—

2. **N8N GitHubä»“åº“**
   - ç½‘å€ï¼šhttps://github.com/n8n-io/n8n
   - å†…å®¹ï¼šæºä»£ç å’Œç¤ºä¾‹èŠ‚ç‚¹

3. **N8Nç¤¾åŒºèŠ‚ç‚¹**
   - ç½‘å€ï¼šhttps://github.com/n8n-io/n8n-nodes
   - å†…å®¹ï¼šç¤¾åŒºè´¡çŒ®çš„èŠ‚ç‚¹

### å­¦ä¹ èµ„æº

1. **TypeScriptå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼šhttps://www.typescriptlang.org/docs/
   - å†…å®¹ï¼šTypeScriptè¯­è¨€å‚è€ƒ

2. **Node.jså®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼šhttps://nodejs.org/docs/
   - å†…å®¹ï¼šNode.js APIå‚è€ƒ

3. **N8Nç¤¾åŒºè®ºå›**
   - ç½‘å€ï¼šhttps://community.n8n.io/
   - å†…å®¹ï¼šç¤¾åŒºè®¨è®ºå’Œé—®é¢˜è§£ç­”

### ç›¸å…³æ•™ç¨‹

1. **N8Nå·¥ä½œæµå¼€å‘æœ€ä½³å®è·µ**
2. **APIé›†æˆæ¨¡å¼**
3. **é”™è¯¯å¤„ç†ç­–ç•¥**
4. **æ€§èƒ½ä¼˜åŒ–æŠ€å·§**

---

## å¿«é€Ÿå‚è€ƒ

### èŠ‚ç‚¹å¼€å‘æ£€æŸ¥æ¸…å•

- [ ] åˆ›å»ºèŠ‚ç‚¹ç›®å½•ç»“æ„
- [ ] å®šä¹‰èŠ‚ç‚¹JSONæ–‡ä»¶
- [ ] å®ç°èŠ‚ç‚¹TypeScriptä»£ç 
- [ ] æ³¨å†ŒèŠ‚ç‚¹
- [ ] åˆ›å»ºCredentialï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ³¨å†ŒCredentialï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] ç¼–è¯‘ä»£ç 
- [ ] æµ‹è¯•èŠ‚ç‚¹åŠŸèƒ½
- [ ] æ·»åŠ é”™è¯¯å¤„ç†
- [ ] ç¼–å†™æ–‡æ¡£

### å¸¸ç”¨ä»£ç ç‰‡æ®µ

**è·å–èŠ‚ç‚¹å‚æ•°**ï¼š
```typescript
const param = this.getNodeParameter('paramName', 0) as string;
```

**è·å–Credential**ï¼š
```typescript
const credentials = await this.getCredentials('credentialName');
```

**å‘é€HTTPè¯·æ±‚**ï¼š
```typescript
const response = await this.helpers.request({
  method: 'GET',
  uri: 'https://api.example.com',
  json: true,
});
```

**è¿”å›æ•°æ®**ï¼š
```typescript
return [[{
  json: { data: 'value' },
  pairedItem: { item: 0 },
}]];
```

---

## ä¸‹ä¸€æ­¥å­¦ä¹ 

å®Œæˆæœ¬æ•™ç¨‹åï¼Œä½ å¯ä»¥ï¼š

1. **æ‰©å±•è‚¡ç¥¨æ•°æ®èŠ‚ç‚¹**ï¼šæ·»åŠ æ›´å¤šAPIæ”¯æŒã€æ·»åŠ å†å²æ•°æ®æŸ¥è¯¢ç­‰
2. **åˆ›å»ºå…¶ä»–è‡ªå®šä¹‰èŠ‚ç‚¹**ï¼šæ ¹æ®ä½ çš„ä¸šåŠ¡éœ€æ±‚åˆ›å»ºèŠ‚ç‚¹
3. **å­¦ä¹ é«˜çº§ç‰¹æ€§**ï¼šå­¦ä¹ èŠ‚ç‚¹çš„é«˜çº§ç‰¹æ€§ï¼Œå¦‚åŠ¨æ€å‚æ•°ã€æ¡ä»¶è¾“å‡ºç­‰
4. **å‚ä¸ç¤¾åŒºè´¡çŒ®**ï¼šå°†ä½ çš„èŠ‚ç‚¹è´¡çŒ®ç»™N8Nç¤¾åŒº

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸš€

